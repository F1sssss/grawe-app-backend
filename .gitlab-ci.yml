stages:
  - smoke_test

variables:
  COMPOSE_PROJECT_NAME: grawe_ci

smoke-test:
  stage: smoke_test
  image: docker:24.0
  tags:
    - windows
  services:
    - docker:24.0-dind
  before_script:
    - apk add --no-cache docker-compose
  script:
    - docker-compose up -d
    - sleep 20
    - docker-compose ps
    - docker-compose logs --tail=50 server
  after_script:
    - docker-compose down -v